<!DOCTYPE html>
<html>

<head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no">
    <link rel="icon" href="tp.ico">
    <title>加载中</title>
    <link rel="stylesheet" href="109.css">
</head>

<body>
    <div class="loader">
        <span>欢</span>
        <span>迎</span>
        <span>来</span>
        <span>到</span>
        <span>我</span>
        <span>的</span>
        <span>网</span>
        <span>站</span>
        <span></span>
        <span></span>
        <span></span>
    </div>

    <script>
        // Function to load HTML files and check material loading status
        function loadAndCheckMaterials() {
            var htmlFiles = ['主页.html', 'sp.html', 'yx.html']; // List of HTML files to load
            var totalMaterialsCount = 0;
            var loadedMaterialsCount = 0;

            function checkAllLoaded() {
                loadedMaterialsCount++;
                if (loadedMaterialsCount === totalMaterialsCount) {
                    // All materials are loaded, redirect to index.html
                    window.location.href = '主页.html';
                }
            }

            htmlFiles.forEach(function (file) {
                fetch(file)
                    .then(function (response) {
                        if (response.ok) {
                            return response.text();
                        } else {
                            throw new Error('Error loading HTML file');
                        }
                    })
                    .then(function (htmlContent) {
                        var tempElement = document.createElement('div');
                        tempElement.innerHTML = htmlContent;

                        // Count the number of images
                        var images = tempElement.querySelectorAll('img');
                        totalMaterialsCount += images.length;

                        // Count the number of background images
                        var elementsWithBackground = tempElement.querySelectorAll('*[style*="background-image"]');
                        elementsWithBackground.forEach(function (element) {
                            if (element.style.backgroundImage.includes('bz.png')) {
                                totalMaterialsCount++;
                            }
                        });

                        // Check if images are loaded
                        images.forEach(function (img) {
                            if (img.complete) {
                                checkAllLoaded();
                            } else {
                                img.onload = function () {
                                    checkAllLoaded();
                                };
                                img.onerror = function () {
                                    console.error('Error loading image:', img.src);
                                };
                            }
                        });

                        // Check if background images are loaded
                        elementsWithBackground.forEach(function (element) {
                            if (element.style.backgroundImage.includes('bz.png')) {
                                var backgroundImageUrl = element.style.backgroundImage.replace('url("', '').replace('")', '');
                                var backgroundImage = new Image();
                                backgroundImage.src = backgroundImageUrl;

                                if (backgroundImage.complete) {
                                    checkAllLoaded();
                                } else {
                                    backgroundImage.onload = function () {
                                        checkAllLoaded();
                                    };
                                    backgroundImage.onerror = function () {
                                        console.error('Error loading background image:', backgroundImageUrl);
                                    };
                                }
                            }
                        });
                    })
                    .catch(function (error) {
                        console.error('Error loading HTML file:', error);
                    });
            });
        }

        // Call the function when the window is loaded
        window.onload = function () {
            loadAndCheckMaterials();
        };
    </script>
</body>

</html>
